"""
더미 데이터 생성 스크립트
전주시 기준 50개 음식점, 500개 메뉴 데이터 생성
"""

import csv
import random
from pathlib import Path

# 전주시 주요 지역 및 주소
JEONJU_DISTRICTS = [
    "완산구 팔복로", "완산구 전주천동로", "완산구 서신동", "완산구 동서학동",
    "완산구 삼천동", "완산구 평화동", "완산구 효자동", "완산구 중화산동",
    "덕진구 전주천서로", "덕진구 금암동", "덕진구 인후동", "덕진구 송천동",
    "덕진구 조촌동", "덕진구 팔복동", "덕진구 전주천동로",
    "완산구 경기전로", "완산구 한옥마을로", "완산구 전동성당길",
    "덕진구 건지산로", "덕진구 동부대로"
]

# 음식점 카테고리별 이름 패턴
RESTAURANT_TYPES = {
    "한식": ["전주비빔밥", "전주콩나물국밥", "전주한정식", "한옥마을", "전통찻집", 
             "된장찌개", "김치찌개", "보리밥", "정식당", "고향식당"],
    "중식": ["짜장면", "짬뽕", "탕수육", "마파두부", "양장피", "깐풍기", 
             "유산슬", "라조기", "팔보채", "울면"],
    "일식": ["스시", "라멘", "우동", "돈부리", "카레", "규동", "회", "초밥", 
             "텐동", "야키니쿠"],
    "양식": ["파스타", "피자", "스테이크", "리조또", "샐러드", "햄버거", 
             "치킨", "샌드위치", "오믈렛", "그라탕"],
    "분식": ["떡볶이", "순대", "어묵", "김밥", "라면", "우동", "만두", 
             "핫도그", "튀김", "비빔밥"],
    "치킨/닭강정": ["후라이드치킨", "양념치킨", "간장치킨", "마늘치킨", 
                  "닭강정", "치킨마요", "양파치킨", "핫치킨", "파닭", "순살치킨"],
    "카페/디저트": ["커피", "케이크", "빙수", "와플", "마카롱", "크로플", 
                   "베이글", "도넛", "아이스크림", "팥빙수"]
}

# 메뉴 데이터 (카테고리별)
MENU_ITEMS = {
    "한식": [
        ("비빔밥", ["쌀(국내산)", "콩나물(전주산)", "시금치(전주산)", "고사리(국내산)", "무(전주산)", "고추장(국내산)"], 8000, 550),
        ("콩나물국밥", ["쌀(국내산)", "콩나물(전주산)", "멸치(국내산)", "마늘(국내산)"], 7000, 480),
        ("된장찌개", ["된장(국내산)", "두부(국내산)", "호박(전주산)", "양파(국내산)", "고추(전주산)"], 8000, 320),
        ("김치찌개", ["김치(전주산)", "돼지고기(국내산)", "두부(국내산)", "대파(국내산)"], 9000, 450),
        ("불고기", ["소고기(국내산)", "양파(국내산)", "당근(국내산)", "대파(국내산)"], 15000, 680),
        ("삼겹살", ["돼지고기(국내산)", "상추(전주산)", "마늘(국내산)", "고추장(국내산)"], 14000, 750),
        ("갈비탕", ["소갈비(국내산)", "무(전주산)", "대파(국내산)", "마늘(국내산)"], 12000, 520),
        ("닭볶음탕", ["닭고기(국내산)", "감자(국내산)", "당근(국내산)", "양파(국내산)"], 13000, 580),
        ("추어탕", ["미꾸라지(국내산)", "미역(국내산)", "콩나물(전주산)"], 9000, 420),
        ("해물파전", ["파(국내산)", "오징어(국내산)", "새우(국내산)", "밀가루(국내산)"], 12000, 650),
    ],
    "중식": [
        ("짜장면", ["면(국내산)", "춘장(중국산)", "돼지고기(국내산)", "양파(국내산)", "오이(국내산)"], 6000, 520),
        ("짬뽕", ["면(국내산)", "해물(국내산)", "양파(국내산)", "고추(국내산)"], 7000, 580),
        ("탕수육", ["돼지고기(국내산)", "밀가루(국내산)", "식초(국내산)", "설탕(국내산)"], 18000, 850),
        ("마파두부", ["두부(국내산)", "돼지고기(국내산)", "대파(국내산)", "고추장(국내산)"], 12000, 420),
        ("양장피", ["해삼(중국산)", "오징어(국내산)", "새우(국내산)", "양파(국내산)"], 25000, 480),
        ("깐풍기", ["닭고기(국내산)", "고추(국내산)", "마늘(국내산)", "생강(국내산)"], 16000, 720),
        ("유산슬", ["소고기(국내산)", "표고버섯(국내산)", "피망(국내산)", "양파(국내산)"], 22000, 650),
        ("라조기", ["닭고기(국내산)", "고추(중국산)", "마늘(국내산)", "생강(국내산)"], 17000, 680),
        ("팔보채", ["해산물(국내산)", "채소(국내산)", "양파(국내산)"], 28000, 520),
        ("울면", ["면(국내산)", "해물(국내산)", "계란(국내산)", "대파(국내산)"], 8000, 580),
    ],
    "일식": [
        ("연어초밥(8pcs)", ["연어(노르웨이산)", "쌀(국내산)", "와사비(일본산)", "간장(국내산)"], 15000, 450),
        ("라멘", ["면(일본산)", "돼지고기(국내산)", "계란(국내산)", "대파(국내산)"], 9000, 580),
        ("우동", ["면(일본산)", "멸치(국내산)", "대파(국내산)", "김(국내산)"], 7000, 480),
        ("돈부리", ["소고기(국내산)", "쌀(국내산)", "양파(국내산)", "계란(국내산)"], 12000, 720),
        ("카레라이스", ["카레(일본산)", "쌀(국내산)", "양파(국내산)", "당근(국내산)"], 9000, 680),
        ("규동", ["소고기(국내산)", "쌀(국내산)", "양파(국내산)", "계란(국내산)"], 11000, 650),
        ("회덮밥", ["회(국내산)", "쌀(국내산)", "오이(국내산)", "무(국내산)"], 18000, 580),
        ("텐동", ["새우튀김(국내산)", "쌀(국내산)", "계란(국내산)", "야채(국내산)"], 12000, 720),
        ("야키니쿠", ["소고기(국내산)", "양파(국내산)", "버섯(국내산)", "파프리카(국내산)"], 20000, 680),
        ("돈까스", ["돼지고기(국내산)", "빵가루(국내산)", "계란(국내산)", "양배추(국내산)"], 11000, 650),
    ],
    "양식": [
        ("크림파스타", ["면(이탈리아산)", "크림(국내산)", "베이컨(국내산)", "양파(국내산)"], 13000, 720),
        ("토마토파스타", ["면(이탈리아산)", "토마토(국내산)", "올리브오일(이탈리아산)", "마늘(국내산)"], 12000, 580),
        ("페퍼로니피자", ["도우(국내산)", "페퍼로니(수입산)", "치즈(국내산)", "토마토소스(국내산)"], 18000, 850),
        ("스테이크", ["소고기(미국산)", "감자(국내산)", "버터(국내산)", "양파(국내산)"], 25000, 680),
        ("리조또", ["쌀(국내산)", "치즈(국내산)", "베이컨(국내산)", "양파(국내산)"], 14000, 650),
        ("시저샐러드", ["양상추(국내산)", "치즈(국내산)", "베이컨(국내산)", "크루통(국내산)"], 11000, 420),
        ("햄버거세트", ["빵(국내산)", "소고기(국내산)", "치즈(국내산)", "야채(국내산)"], 8000, 720),
        ("치킨텐더", ["닭고기(국내산)", "빵가루(국내산)", "감자(국내산)"], 13000, 650),
        ("오믈렛", ["계란(국내산)", "치즈(국내산)", "베이컨(국내산)", "양파(국내산)"], 9000, 480),
        ("그라탕", ["감자(국내산)", "치즈(국내산)", "베이컨(국내산)", "양파(국내산)"], 12000, 580),
    ],
    "분식": [
        ("떡볶이", ["떡(국내산)", "고추장(국내산)", "어묵(국내산)", "대파(국내산)"], 4000, 320),
        ("순대", ["돼지고기(국내산)", "쌀(국내산)", "대파(국내산)"], 5000, 280),
        ("어묵탕", ["어묵(국내산)", "대파(국내산)", "멸치(국내산)"], 4000, 180),
        ("김밥", ["김(국내산)", "쌀(국내산)", "단무지(국내산)", "시금치(국내산)"], 3500, 280),
        ("라면", ["면(국내산)", "계란(국내산)", "대파(국내산)"], 4000, 380),
        ("만두", ["돼지고기(국내산)", "김치(전주산)", "대파(국내산)", "밀가루(국내산)"], 5000, 350),
        ("핫도그", ["소시지(국내산)", "빵(국내산)", "양파(국내산)"], 4000, 420),
        ("튀김세트", ["고구마(국내산)", "오징어(국내산)", "감자(국내산)", "밀가루(국내산)"], 6000, 480),
        ("비빔국수", ["면(국내산)", "오이(국내산)", "고추장(국내산)", "계란(국내산)"], 6000, 450),
        ("치즈돈까스", ["돼지고기(국내산)", "치즈(국내산)", "빵가루(국내산)", "양배추(국내산)"], 7000, 650),
    ],
    "치킨/닭강정": [
        ("후라이드치킨(순살)", ["닭고기(국내산)", "빵가루(국내산)", "식용유(국내산)"], 17000, 1250),
        ("양념치킨(순살)", ["닭고기(국내산)", "양념소스(국내산)", "마늘(국내산)"], 18000, 1380),
        ("간장치킨(순살)", ["닭고기(국내산)", "간장(국내산)", "마늘(국내산)", "대파(국내산)"], 18000, 1320),
        ("마늘치킨(순살)", ["닭고기(국내산)", "마늘(국내산)", "간장(국내산)"], 19000, 1350),
        ("닭강정", ["닭고기(국내산)", "고추장(국내산)", "마늘(국내산)", "꿀(국내산)"], 16000, 980),
        ("치킨마요덮밥", ["닭고기(국내산)", "쌀(국내산)", "마요네즈(국내산)", "계란(국내산)"], 8000, 720),
        ("양파치킨(순살)", ["닭고기(국내산)", "양파(국내산)", "양념소스(국내산)"], 19000, 1400),
        ("핫치킨(순살)", ["닭고기(국내산)", "고추(국내산)", "마늘(국내산)"], 19000, 1380),
        ("파닭", ["닭고기(국내산)", "대파(국내산)", "마늘(국내산)", "간장(국내산)"], 17000, 1250),
        ("뿌링클치킨(순살)", ["닭고기(국내산)", "치즈가루(국내산)", "마요네즈(국내산)"], 19000, 1420),
    ],
    "카페/디저트": [
        ("아메리카노", ["원두(에티오피아산)", "물(국내산)"], 4500, 5),
        ("카페라떼", ["원두(에티오피아산)", "우유(국내산)", "물(국내산)"], 5000, 150),
        ("카푸치노", ["원두(에티오피아산)", "우유(국내산)", "우유거품(국내산)"], 5500, 120),
        ("치즈케이크", ["크림치즈(국내산)", "설탕(국내산)", "계란(국내산)", "밀가루(국내산)"], 7000, 380),
        ("초콜릿케이크", ["초콜릿(벨기에산)", "버터(국내산)", "설탕(국내산)", "계란(국내산)"], 7500, 450),
        ("팥빙수", ["팥(국내산)", "우유(국내산)", "설탕(국내산)", "얼음(국내산)"], 8000, 350),
        ("와플", ["밀가루(국내산)", "버터(국내산)", "계란(국내산)", "설탕(국내산)"], 6000, 420),
        ("마카롱(4개)", ["아몬드(미국산)", "설탕(국내산)", "계란(국내산)", "버터(국내산)"], 12000, 320),
        ("크로플", ["밀가루(국내산)", "버터(국내산)", "설탕(국내산)", "계란(국내산)"], 5500, 380),
        ("아이스크림(2구)", ["우유(국내산)", "설탕(국내산)", "바닐라(마다가스카르산)"], 5000, 280),
    ]
}

# 전주시 특색 음식점 추가
JEONJU_SPECIAL = [
    ("전주비빔밥", ["쌀(국내산)", "콩나물(전주산)", "시금치(전주산)", "고사리(국내산)", "무(전주산)", "고추장(전주산)"], 12000, 550),
    ("전주콩나물국밥", ["쌀(국내산)", "콩나물(전주산)", "멸치(국내산)", "마늘(국내산)"], 10000, 480),
    ("한정식", ["쌀(국내산)", "된장국(전주산)", "나물(전주산)", "김치(전주산)"], 15000, 650),
    ("모듬전", ["부추전(전주산)", "해물전(국내산)", "고추전(전주산)"], 18000, 520),
    ("전주피순대", ["순대(전주산)", "콩나물(전주산)", "양파(국내산)"], 12000, 580),
]

def generate_restaurant_name(category):
    """음식점 이름 생성"""
    names = RESTAURANT_TYPES.get(category, RESTAURANT_TYPES["한식"])
    base_name = random.choice(names)
    prefixes = ["맛있는", "전주", "오래된", "유명한", "전통", "향토", "고향", "정통", "명가", "본가"]
    suffix_numbers = ["", "1호점", "2호점", "", "", ""]  # 일부만 번호 추가
    
    if random.random() < 0.3:  # 30% 확률로 접두사 추가
        prefix = random.choice(prefixes)
        name = f"{prefix}{base_name}"
    else:
        name = base_name
    
    if random.random() < 0.2:  # 20% 확률로 번호 추가
        suffix = random.choice(suffix_numbers)
        if suffix:
            name = f"{name} {suffix}"
    
    return name

def generate_address():
    """전주시 주소 생성"""
    district = random.choice(JEONJU_DISTRICTS)
    building_number = random.randint(1, 999)
    detail_number = random.choice([None, None, None, random.randint(101, 599)])  # 일부만 상세번호
    
    address = f"전주시 {district} {building_number}"
    if detail_number:
        address += f"-{detail_number}"
    
    return address

def generate_restaurant_data():
    """음식점 데이터 생성"""
    restaurants = []
    
    # 카테고리별로 음식점 분배
    categories = list(MENU_ITEMS.keys())
    restaurant_count_per_category = [10, 8, 8, 8, 8, 5, 3]  # 카테고리별 개수
    
    restaurant_id = 1
    menu_id = 1
    
    for cat_idx, category in enumerate(categories):
        count = restaurant_count_per_category[cat_idx]
        
        for i in range(count):
            restaurant_name = generate_restaurant_name(category)
            address = generate_address()
            
            # 각 음식점마다 8-12개 메뉴 생성
            menu_count = random.randint(8, 12)
            menus = random.sample(MENU_ITEMS[category], min(menu_count, len(MENU_ITEMS[category])))
            
            # 전주 특색 음식점인 경우 추가 메뉴
            if category == "한식" and random.random() < 0.3:
                special_menu = random.choice(JEONJU_SPECIAL)
                if special_menu not in menus:
                    menus.append(special_menu)
            
            for menu_item in menus:
                menu_name, ingredients, price, calories = menu_item
                
                # 가격에 약간의 변동성 추가 (±500원)
                price_variation = random.randint(-500, 500)
                final_price = max(5000, price + price_variation)  # 최소 5000원
                
                # 칼로리에 약간의 변동성 추가 (±30kcal)
                calories_variation = random.randint(-30, 30)
                final_calories = max(50, calories + calories_variation)
                
                ingredients_str = ", ".join(ingredients)
                
                restaurants.append({
                    "restaurant_id": restaurant_id,
                    "restaurant_name": restaurant_name,
                    "address": address,
                    "category": category,
                    "menu_id": menu_id,
                    "menu_name": menu_name,
                    "ingredients_origin": ingredients_str,
                    "price": final_price,
                    "calories": final_calories
                })
                menu_id += 1
            
            restaurant_id += 1
    
    return restaurants

def main():
    """메인 함수"""
    print("전주시 음식점 더미 데이터 생성 시작...")
    
    # 데이터 디렉토리 확인 및 생성
    data_dir = Path(__file__).parent.parent / "data"
    data_dir.mkdir(parents=True, exist_ok=True)
    
    # 음식점 데이터 생성
    restaurants = generate_restaurant_data()
    
    # CSV 파일로 저장
    output_file = data_dir / "restaurant_menu_data.csv"
    
    fieldnames = [
        "restaurant_id",
        "restaurant_name",
        "address",
        "category",
        "menu_id",
        "menu_name",
        "ingredients_origin",
        "price",
        "calories"
    ]
    
    with open(output_file, 'w', newline='', encoding='utf-8-sig') as f:
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        writer.writerows(restaurants)
    
    # 통계 출력
    unique_restaurants = len(set(r["restaurant_id"] for r in restaurants))
    total_menus = len(restaurants)
    
    print(f"\n데이터 생성 완료!")
    print(f"- 음식점 개수: {unique_restaurants}개")
    print(f"- 메뉴 개수: {total_menus}개")
    print(f"- 파일 위치: {output_file}")
    
    # 카테고리별 통계
    category_stats = {}
    for r in restaurants:
        cat = r["category"]
        if cat not in category_stats:
            category_stats[cat] = {"restaurants": set(), "menus": 0}
        category_stats[cat]["restaurants"].add(r["restaurant_id"])
        category_stats[cat]["menus"] += 1
    
    print("\n카테고리별 통계:")
    for cat, stats in category_stats.items():
        print(f"  {cat}: 음식점 {len(stats['restaurants'])}개, 메뉴 {stats['menus']}개")

if __name__ == "__main__":
    main()

